# ========== USER PROFILE TAB ==========
title: Profile
path: profile
icon: mdi:account-circle
type: panel
cards:
  - type: vertical-stack
    cards:
      - type: conditional
        conditions:
          - entity: sensor.research_phase
            state: baseline
        card:
          type: markdown
          content: |
            ## üöß Profile Building...
            üîß We are currently calibrating your baseline. 
            Your personal eco-stats and levels will unlock in **{{ state_attr('sensor.research_phase', 'days_remaining') }} days**. ‚è≥

      - type: conditional
        conditions:
          - entity: sensor.research_phase
            state: active
        card:
          type: vertical-stack
          cards:
            # --- PLAYER LEVEL CARD ---
            - type: markdown
              content: |
                {% set tasks = states('sensor.tasks_completed') | int %}
                {% if tasks < 5 %}
                # üê£ Level 1: Novice
                *Complete more daily tasks to evolve!* üå±
                {% elif tasks < 15 %}
                # üåø Level 2: Eco-Apprentice
                *You're getting the hang of this!* üí™
                {% elif tasks < 30 %}
                # üå≥ Level 3: Guardian
                *Amazing dedication!* ‚≠ê
                {% else %}
                # üëë Level 4: Planet Master
                *You are an energy saving legend.* üèÜ
                {% endif %}
                
                ---
                **üìä Total Tasks Completed:** {{ tasks }}

            # --- RPG STATS GAUGES ---
            - type: horizontal-stack
              cards:
                - type: gauge
                  entity: sensor.behaviour_index
                  name: üí™ Engagement
                  min: 0
                  max: 1
                  severity:
                    red: 0
                    yellow: 0.4
                    green: 0.8
                
                - type: gauge
                  entity: sensor.fatigue_index
                  name: üò¥ Fatigue Risk
                  min: 0
                  max: 1
                  severity:
                    green: 0
                    yellow: 0.5
                    red: 0.8

            # --- TOTAL IMPACT GLANCE ---
            - type: glance
              title: üåü Lifetime Impact
              columns: 3
              entities:
                - entity: sensor.savings_accumulated
                  name: üí∞ Money Saved
                - entity: sensor.co2_saved
                  name: üå± CO‚ÇÇ Avoided
                - entity: sensor.weekly_challenge
                  name: üéØ Current Goal

            # --- "DID YOU KNOW?" CONTEXT ---
            - type: markdown
              content: |
                ### üåç Your Real-World Impact
                {% set trees = state_attr('sensor.co2_saved', 'trees') %}
                {% set flights = state_attr('sensor.co2_saved', 'flights') %}
                {% set km = state_attr('sensor.co2_saved', 'car_km') %}
                
                Your savings so far are equivalent to:
                * üå≤ Planting **{{ trees }} mature trees**
                * ‚úàÔ∏è Offsetting **{{ flights }} short-haul flights**
                * üöó Avoiding **{{ km }} km** driven in a gas car
